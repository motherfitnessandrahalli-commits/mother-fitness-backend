<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultra Fitness - Gym Management System</title>
    <p>Please enter your password to access the system.</p>
    <div id="login-error" style="color: red; display: none; margin-bottom: 10px; font-size: 14px;"></div>
    <form id="login-form">
        <input type="email" id="login-email" placeholder="Email Address" required>
        <input type="password" id="login-password" placeholder="Password" required>
        <button type="submit" class="btn btn-primary">Login</button>
    </form>
    <p style="margin-top: 10px; font-size: 12px; color: #888; text-align: center;">
        Default: admin@ultrafitness.com / 0000
    </p>
    </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="notification-container"></div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üí™</div>
                    <h1>Ultra Fitness</h1>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary btn-icon-only" id="hamburger-btn">
                        <span class="hamburger-icon">‚ò∞</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <!-- Dashboard Stats -->
            <section class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon total">üë•</div>
                    <div class="stat-info">
                        <h3 id="total-customers">0</h3>
                        <p>Total Customers</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon active">‚úÖ</div>
                    <div class="stat-info">
                        <h3 id="active-customers">0</h3>
                        <p>Active Plans</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon expiring">‚ö†Ô∏è</div>
                    <div class="stat-info">
                        <h3 id="expiring-customers">0</h3>
                        <p>Expiring Soon</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon expired">‚ùå</div>
                    <div class="stat-info">
                        <h3 id="expired-customers">0</h3>
                        <p>Expired Plans</p>
                    </div>
                </div>
            </section>

            <!-- Search and Filter Section -->
            <section class="controls-section">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="search-input" placeholder="Search by name, email, or phone...">
                </div>
                <div class="filter-controls">
                    <button id="notify-expired-btn" class="btn btn-warning" style="display: none;">
                        <span class="btn-icon">üìß</span>
                        Notify All Expired
                    </button>
                    <select id="filter-status" class="filter-select">
                        <option value="all">All Customers</option>
                        <option value="active">Active Plans</option>
                        <option value="expiring">Expiring Soon (7 days)</option>
                        <option value="expired">Expired Plans</option>
                    </select>
                    <select id="sort-by" class="filter-select">
                        <option value="name">Sort by Name</option>
                        <option value="date-newest">Newest First</option>
                        <option value="date-oldest">Oldest First</option>
                        <option value="validity">Plan Validity</option>
                    </select>
                </div>
            </section>

            <!-- Customer List -->
            <section class="customer-list-section">
                <div id="customer-list" class="customer-list">
                    <!-- Customer cards will be dynamically inserted here -->
                </div>
                <div id="empty-state" class="empty-state">
                    <div class="empty-icon">üìã</div>
                    <h2>No Customers Found</h2>
                    <p>Start by adding your first customer to the system</p>
                    <button class="btn btn-primary" onclick="openCustomerModal()">
                        <span class="btn-icon">+</span>
                        Add First Customer
                    </button>
                </div>
            </section>

            <!-- Analytics Dashboard (Hidden by default) -->
            <section id="analytics-dashboard" class="analytics-dashboard" style="display: none;">
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>Plan Popularity</h3>
                        <div class="chart-container">
                            <canvas id="planChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>Customer Age Demographics</h3>
                        <div class="chart-container">
                            <canvas id="ageChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card full-width">
                        <h3>Business Growth (New Customers)</h3>
                        <div class="chart-container">
                            <canvas id="growthChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Attendance Dashboard (Hidden by default) -->
            <section id="attendance-dashboard" class="attendance-dashboard" style="display: none;">
                <div class="attendance-header">
                    <h2>üìã Attendance Tracker</h2>
                    <div class="attendance-controls">
                        <input type="date" id="attendance-date-filter" class="filter-select">
                        <button class="btn btn-success" id="export-attendance-btn">
                            <span class="btn-icon">üì•</span>
                            Export Attendance
                        </button>
                    </div>
                </div>

                <div class="attendance-stats">
                    <div class="stat-card">
                        <div class="stat-icon total">‚úÖ</div>
                        <div class="stat-info">
                            <h3 id="today-checkins">0</h3>
                            <p>Today's Check-ins</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon active">üü¢</div>
                        <div class="stat-info">
                            <h3 id="active-checkins">0</h3>
                            <p>Active Members</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon expired">üî¥</div>
                        <div class="stat-info">
                            <h3 id="expired-checkins">0</h3>
                            <p>Expired Members</p>
                        </div>
                    </div>
                </div>

                <div class="attendance-list-section">
                    <h3>Check-in Records</h3>
                    <div id="attendance-list" class="attendance-list">
                        <!-- Attendance records will be dynamically inserted here -->
                    </div>
                    <div id="attendance-empty-state" class="empty-state">
                        <div class="empty-icon">üìã</div>
                        <h2>No Check-ins Yet</h2>
                        <p>Scan QR codes to mark attendance</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Customer Modal -->
    <div id="customer-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Add New Customer</h2>
                <button class="close-btn" onclick="closeCustomerModal()">&times;</button>
            </div>
            <form id="customer-form">
                <!-- Profile Photo Section -->
                <div class="profile-photo-section">
                    <div class="profile-photo-container">
                        <div class="profile-photo-preview" id="profile-photo-preview">
                            <img id="profile-image" src="" alt="Profile Photo" style="display: none;">
                            <div class="profile-placeholder" id="profile-placeholder">
                                <span class="placeholder-icon">üì∑</span>
                                <span class="placeholder-text">Add Photo</span>
                            </div>
                        </div>
                        <input type="file" id="profile-photo-input" accept="image/*" capture="user"
                            style="display: none;">
                        <button type="button" class="btn btn-secondary btn-camera" id="add-photo-btn">
                            <span class="btn-icon">üì∑</span>
                            Take Photo
                        </button>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="customer-name">Full Name *</label>
                        <input type="text" id="customer-name" required placeholder="Enter full name">
                    </div>
                    <div class="form-group">
                        <label for="customer-age">Age *</label>
                        <input type="number" id="customer-age" required min="10" max="120" placeholder="Enter age">
                    </div>
                    <div class="form-group">
                        <label for="customer-email">Email Address *</label>
                        <input type="email" id="customer-email" required placeholder="email@example.com">
                    </div>
                    <div class="form-group">
                        <label for="customer-phone">Phone Number *</label>
                        <input type="tel" id="customer-phone" required placeholder="+91 XXXXX XXXXX">
                    </div>
                    <div class="form-group">
                        <label for="customer-plan">Plan Type *</label>
                        <select id="customer-plan" class="ios-select" required>
                            <option value="">Select Plan</option>
                            <option value="Monthly">Monthly</option>
                            <option value="Quarterly">Quarterly (3 Months)</option>
                            <option value="Half-Yearly">Half-Yearly (6 Months)</option>
                            <option value="Yearly">Yearly (12 Months)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="customer-validity">Plan Validity (End Date) *</label>
                        <input type="date" id="customer-validity" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="customer-notes">Additional Notes</label>
                    <textarea id="customer-notes" rows="3" placeholder="Any additional information..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeCustomerModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submit-btn">
                        <span class="btn-icon">üíæ</span>
                        Save Customer
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Confirm Delete</h2>
                <button class="close-btn" onclick="closeDeleteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete <strong id="delete-customer-name"></strong>?</p>
                <p class="warning-text">This action cannot be undone.</p>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirm-delete-btn">
                    <span class="btn-icon">üóëÔ∏è</span>
                    Delete Customer
                </button>
            </div>
        </div>
    </div>

    <!-- Image Enlargement Modal -->
    <div id="image-modal" class="modal">
        <div class="modal-content modal-image">
            <div class="modal-header">
                <h2>Profile Photo</h2>
                <button class="close-btn" onclick="closeImageModal()">&times;</button>
            </div>
            <div class="modal-body modal-image-body">
                <img id="enlarged-image" src="" alt="Profile Photo">
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="edit-photo-btn">
                    <span class="btn-icon">‚úèÔ∏è</span>
                    Edit Photo
                </button>
                <button type="button" class="btn btn-danger" id="delete-photo-btn">
                    <span class="btn-icon">üóëÔ∏è</span>
                    Delete Photo
                </button>
            </div>
        </div>
    </div>

    <!-- Camera Modal -->
    <div id="camera-modal" class="modal">
        <div class="modal-content modal-camera">
            <div class="modal-header">
                <h2>Take Photo</h2>
                <button class="close-btn" onclick="closeCameraModal()">√ó</button>
            </div>
            <div class="modal-body camera-body">
                <video id="camera-video" autoplay playsinline></video>
                <canvas id="camera-canvas" style="display: none;"></canvas>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeCameraModal()">Cancel</button>
                <button type="button" class="btn btn-primary" id="capture-photo-btn">
                    <span class="btn-icon">üì∏</span>
                    Capture Photo
                </button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="password-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Change Password</h2>
                <button class="close-btn" onclick="closePasswordModal()">&times;</button>
            </div>
            <form id="password-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="current-password">Current Password</label>
                        <input type="password" id="current-password" required placeholder="Enter current password">
                    </div>
                    <div class="form-group">
                        <label for="new-password">New Password</label>
                        <input type="password" id="new-password" required placeholder="Enter new password">
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirm New Password</label>
                        <input type="password" id="confirm-password" required placeholder="Confirm new password">
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closePasswordModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Password</button>
                </div>
            </form>
        </div>
    </div>

    <!-- QR Code Display Modal -->
    <div id="qr-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Member QR Code</h2>
                <button class="close-btn" onclick="closeQRModal()">&times;</button>
            </div>
            <div class="modal-body qr-modal-body">
                <div class="qr-customer-info">
                    <h3 id="qr-customer-name"></h3>
                    <p id="qr-customer-plan"></p>
                </div>
                <div id="qr-code-container" class="qr-code-container"></div>
                <p class="qr-instructions">Scan this QR code at the gym entrance to mark attendance</p>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeQRModal()">Close</button>
                <button type="button" class="btn btn-primary" id="download-qr-btn">
                    <span class="btn-icon">üì•</span>
                    Download QR Code
                </button>
            </div>
        </div>
    </div>

    <!-- QR Scanner Modal -->
    <div id="scanner-modal" class="modal">
        <div class="modal-content modal-scanner">
            <div class="modal-header">
                <h2>üì∑ Scan Member QR Code</h2>
                <button class="close-btn" onclick="closeScannerModal()">&times;</button>
            </div>
            <div class="modal-body scanner-body">
                <div id="qr-reader" class="qr-reader"></div>
                <div class="scanner-instructions">
                    <p>üì± Position the QR code within the frame</p>
                    <p>üéØ Scanner will automatically detect and process</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Attendance Success Modal -->
    <div id="attendance-success-modal" class="modal">
        <div class="modal-content modal-small attendance-success-content">
            <div class="modal-body">
                <div class="success-animation" id="success-animation">
                    <div class="success-icon">‚úÖ</div>
                </div>
                <h2 id="attendance-member-name"></h2>
                <div class="attendance-status-badge" id="attendance-status-badge"></div>
                <p class="attendance-time" id="attendance-time"></p>
                <p class="attendance-message" id="attendance-message"></p>
            </div>
        </div>
    </div>

    <!-- Hamburger Menu Backdrop -->
    <div id="hamburger-backdrop" class="hamburger-backdrop" onclick="closeHamburgerMenu()"></div>

    <!-- Hamburger Menu -->
    <div id="hamburger-menu" class="hamburger-menu">
        <div class="hamburger-menu-content">
            <div class="hamburger-menu-header">
                <h3>Menu</h3>
                <button class="hamburger-close" onclick="closeHamburgerMenu()">√ó</button>
            </div>
            <div class="hamburger-menu-nav">
                <div class="menu-item" id="menu-add-customer-btn">
                    <span class="menu-icon">üë§</span>
                    <span class="menu-text">Add Customer</span>
                </div>

                <div class="menu-divider"></div>

                <div class="menu-item" id="menu-scan-qr-btn">
                    <span class="menu-icon">üì∑</span>
                    <span class="menu-text">Scan QR Code</span>
                </div>

                <div class="menu-item" id="menu-attendance-btn">
                    <span class="menu-icon">üìã</span>
                    <span class="menu-text">Attendance</span>
                </div>

                <div class="menu-item" id="menu-analytics-btn">
                    <span class="menu-icon">üìä</span>
                    <span class="menu-text">Analytics</span>
                </div>

                <div class="menu-divider"></div>

                <div class="menu-item" id="menu-import-btn">
                    <span class="menu-icon">üì•</span>
                    <span class="menu-text">Import Excel</span>
                </div>
                <input type="file" id="import-excel-input" accept=".xlsx, .xls" style="display: none;">

                <div class="menu-item" id="menu-export-btn">
                    <span class="menu-icon">üì§</span>
                    <span class="menu-text">Export Excel</span>
                </div>

                <div class="menu-divider"></div>

                <div class="menu-item" id="menu-theme-toggle">
                    <span class="menu-icon">üåô</span>
                    <span class="menu-text">Dark Mode</span>
                </div>

                <div class="menu-item" id="menu-password-btn">
                    <span class="menu-icon">üîí</span>
                    <span class="menu-text">Change Password</span>
                </div>
            </div>
        </div>
    </div>

    <script src="api.js"></script>

    <script src="app.js"></script>

    <!-- Payment Modal -->
    <div id="payment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Record Payment</h2>
                <span class="close-modal" onclick="app.closePaymentModal()">&times;</span>
            </div>
            <form id="payment-form" onsubmit="app.handlePaymentSubmit(event)">
                <input type="hidden" id="payment-customer-id">
                <div class="form-group">
                    <label>Customer Name</label>
                    <input type="text" id="payment-customer-name" readonly
                        style="background: #f5f6fa; width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                </div>
                <div class="form-group">
                    <label>Amount (‚Çπ)</label>
                    <input type="number" id="payment-amount" required
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                </div>
                <div class="form-group">
                    <label>Payment Date</label>
                    <input type="date" id="payment-date" required
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                </div>
                <div class="form-group">
                    <label>Payment Method</label>
                    <select id="payment-method" required
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <option value="Cash">Cash</option>
                        <option value="UPI">UPI</option>
                        <option value="Card">Card</option>
                        <option value="Bank Transfer">Bank Transfer</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Plan Type</label>
                    <select id="payment-plan" required
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <option value="Monthly">Monthly</option>
                        <option value="Quarterly">Quarterly</option>
                        <option value="Half-Yearly">Half-Yearly</option>
                        <option value="Yearly">Yearly</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Receipt Number (Optional)</label>
                    <input type="text" id="payment-receipt"
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="payment-notes" rows="2"
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 15px;">Save
                    Payment</button>
            </form>
        </div>
    </div>

    <!-- Payment View Overlay -->
    <div id="payment-view" class="view-overlay"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 1000; overflow-y: auto;">
        <div class="view-header"
            style="padding: 20px; background: #6c5ce7; color: white; display: flex; justify-content: space-between; align-items: center;">
            <h2>Payment History</h2>
            <button class="btn-icon" onclick="app.togglePaymentView()"
                style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">‚úï</button>
        </div>
        <div class="view-content" style="padding: 20px;">
            <div class="search-bar" style="margin-bottom: 20px;">
                <input type="text" id="payment-search" placeholder="Search payments..." onkeyup="app.filterPayments()"
                    style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px;">
            </div>
            <div class="table-container">
                <table class="data-table" style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f8f9fa; text-align: left;">
                            <th style="padding: 12px;">Date</th>
                            <th style="padding: 12px;">Customer</th>
                            <th style="padding: 12px;">Amount</th>
                            <th style="padding: 12px;">Method</th>
                            <th style="padding: 12px;">Plan</th>
                            <th style="padding: 12px;">Status</th>
                            <th style="padding: 12px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="payment-table-body">
                        <!-- Payments will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    </body>

</html>