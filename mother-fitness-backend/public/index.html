<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mother Fitness - Gym Management System</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Login Overlay -->
    <div id="login-overlay" class="login-overlay">
        <div class="login-card">
            <div class="login-icon">üîí</div>
            <h2 class="login-title">Welcome Back</h2>
            <p class="login-subtitle">Please enter your password to access the system.</p>
            <div id="login-error" class="login-error"></div>
            <form id="login-form" class="login-form">
                <input type="email" id="login-email" class="login-input" placeholder="admin@motherfitness.com" required>
                <input type="password" id="login-password" class="login-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                <button type="submit" class="btn login-btn">Login</button>
            </form>
            <p class="login-footer">
                Default: admin@motherfitness.com / 0000
            </p>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="notification-container"></div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üí™</div>
                    <h1>Mother Fitness</h1>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary btn-icon-only" id="hamburger-btn">
                        <span class="hamburger-icon">‚ò∞</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <!-- Dashboard Stats -->
            <section class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon total">üë•</div>
                    <div class="stat-info">
                        <h3 id="total-customers">0</h3>
                        <p>Total Customers</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon active">‚úÖ</div>
                    <div class="stat-info">
                        <h3 id="active-customers">0</h3>
                        <p>Active Plans</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon expiring">‚ö†Ô∏è</div>
                    <div class="stat-info">
                        <h3 id="expiring-customers">0</h3>
                        <p>Expiring Soon</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon expired">‚ùå</div>
                    <div class="stat-info">
                        <h3 id="expired-customers">0</h3>
                        <p>Expired Plans</p>
                    </div>
                </div>
                <!-- Live Gym Count Widget -->
                <div class="stat-card live-count-card"
                    style="background: linear-gradient(135deg, rgba(46, 213, 115, 0.2), rgba(84, 160, 255, 0.2)); border: 1px solid rgba(46, 213, 115, 0.3);">
                    <div class="stat-icon live" style="background: rgba(46, 213, 115, 0.2); color: #2ed573;">üî•</div>
                    <div class="stat-info">
                        <h3 id="live-gym-count">0</h3>
                        <p>Inside Gym Now</p>
                    </div>
                    <div class="live-indicator">
                        <span class="pulse"></span>
                        LIVE
                    </div>
                </div>
            </section>

            <!-- Search and Filter Section -->
            <section class="controls-section">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="search-input" placeholder="Search by name, email, or phone...">
                </div>
                <div class="filter-controls">
                    <button id="notify-expired-btn" class="btn btn-warning" style="display: none;">
                        <span class="btn-icon">üìß</span>
                        Notify All Expired
                    </button>
                    <button id="sync-badges-btn" class="btn btn-secondary" onclick="app.syncBadges()">
                        <span class="btn-icon">üèÜ</span>
                        Sync Badges
                    </button>
                    <button id="device-settings-btn" class="btn btn-secondary" onclick="app.toggleDeviceSettings()">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        Device Settings
                    </button>
                    <select id="filter-status" class="filter-select">
                        <option value="all">All Customers</option>
                        <option value="active">Active Plans</option>
                        <option value="expiring">Expiring Soon (7 days)</option>
                        <option value="expired">Expired Plans</option>
                    </select>
                    <select id="sort-by" class="filter-select">
                        <option value="name">Sort by Name</option>
                        <option value="date-newest">Newest First</option>
                        <option value="date-oldest">Oldest First</option>
                        <option value="validity">Plan Validity</option>
                    </select>
                </div>
            </section>

            <!-- Customer List -->
            <section class="customer-list-section">
                <div id="customer-list" class="customer-list">
                    <!-- Customer cards will be dynamically inserted here -->
                </div>
                <div id="empty-state" class="empty-state">
                    <div class="empty-icon">üìã</div>
                    <h2>No Customers Found</h2>
                    <p>Start by adding your first customer to the system</p>
                    <button class="btn btn-primary" onclick="openCustomerModal()">
                        <span class="btn-icon">+</span>
                        Add First Customer
                    </button>
                </div>
            </section>

            <!-- Analytics Dashboard (Hidden by default) -->
            <section id="analytics-dashboard" class="analytics-dashboard" style="display: none;">
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>Plan Popularity</h3>
                        <div class="chart-container">
                            <canvas id="planChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>Customer Age Demographics</h3>
                        <div class="chart-container">
                            <canvas id="ageChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card full-width">
                        <h3>Business Growth (New Customers)</h3>
                        <div class="chart-container">
                            <canvas id="growthChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Attendance Dashboard (Hidden by default) -->
            <section id="attendance-dashboard" class="attendance-dashboard" style="display: none;">
                <div class="attendance-header">
                    <h2>üìã Attendance Tracker</h2>
                    <div class="attendance-controls">
                        <input type="date" id="attendance-date-filter" class="filter-select">
                        <button class="btn btn-success" id="export-attendance-btn">
                            <span class="btn-icon">üì•</span>
                            Export Attendance
                        </button>
                    </div>
                </div>

                <div class="attendance-stats">
                    <div class="stat-card">
                        <div class="stat-icon total">‚úÖ</div>
                        <div class="stat-info">
                            <h3 id="today-checkins">0</h3>
                            <p>Today's Check-ins</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon active">üü¢</div>
                        <div class="stat-info">
                            <h3 id="active-checkins">0</h3>
                            <p>Active Members</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon expired">üî¥</div>
                        <div class="stat-info">
                            <h3 id="expired-checkins">0</h3>
                            <p>Expired Members</p>
                        </div>
                    </div>
                </div>

                <div class="attendance-list-section">
                    <h3>Check-in Records</h3>
                    <div id="attendance-list" class="attendance-list">
                        <!-- Attendance records will be dynamically inserted here -->
                    </div>
                    <div id="attendance-empty-state" class="empty-state">
                        <div class="empty-icon">üìã</div>
                        <h2>No Check-ins Yet</h2>
                        <p>Use biometrics or manual entry to mark attendance</p>
                    </div>
                </div>
            </section>

            <!-- Intelligence Dashboard (Hidden by default) -->
            <section id="intelligence-dashboard" class="intelligence-dashboard" style="display: none;">
                <div class="intelligence-header">
                    <h2>üß† Gym Management Intelligence</h2>
                    <button class="btn btn-outline" onclick="app.toggleIntelligenceView()">Back to Dashboard</button>
                </div>

                <div class="intelligence-grid">
                    <!-- Business Health Score Card -->
                    <div class="intel-card">
                        <h3>Business Health Score</h3>
                        <div class="circular-chart-container">
                            <svg viewBox="0 0 36 36" class="circular-chart">
                                <path class="circle-bg" d="M18 2.0845
                                    a 15.9155 15.9155 0 0 1 0 31.831
                                    a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <path id="health-score-circle" class="circle" stroke-dasharray="0, 100" d="M18 2.0845
                                    a 15.9155 15.9155 0 0 1 0 31.831
                                    a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <text x="18" y="20.35" class="percentage" id="health-score-val">0%</text>
                            </svg>
                        </div>
                        <div id="health-status">Checking...</div>
                    </div>

                    <!-- Churn Risk Card -->
                    <div class="intel-card">
                        <h3>Churn Prediction (High Risk)</h3>
                        <div class="stat-value" id="churn-count">0</div>
                        <p class="stat-label">Members likely to leave</p>
                        <div class="mini-list" id="churn-list">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Revenue Leakage Card -->
                    <div class="intel-card">
                        <h3>Revenue Protection</h3>
                        <div class="stat-value" id="leakage-count">0</div>
                        <p class="stat-label">Expired but actively visiting</p>
                        <p class="stat-meta">Potential lost revenue this month</p>
                    </div>
                </div>
            </section>

            <!-- Device Settings Dashboard (Hidden by default) -->
            <section id="device-settings-dashboard" class="device-settings-dashboard" style="display: none;">
                <div class="intelligence-header">
                    <h2>‚öôÔ∏è Device Settings & Management</h2>
                    <button class="btn btn-outline" onclick="app.toggleDeviceSettings()">Back to Dashboard</button>
                </div>

                <!-- Connection Status Banner -->
                <div id="connection-status-banner" class="connection-status disconnected">
                    <span class="status-indicator">‚óè</span>
                    <span id="status-text">Not Connected</span>
                </div>

                <div class="settings-grid">
                    <!-- Device Configuration Card -->
                    <div class="settings-card">
                        <h3>üîß Device Configuration</h3>
                        <div class="form-group">
                            <label for="device-ip">Device IP Address</label>
                            <input type="text" id="device-ip" class="form-input" placeholder="192.168.1.201" value="">
                        </div>
                        <div class="form-group">
                            <label for="device-port">Port</label>
                            <input type="number" id="device-port" class="form-input" placeholder="4370" value="4370">
                        </div>
                        <div class="form-group">
                            <label for="device-role">Device Role (IN/OUT)</label>
                            <select id="device-role" class="form-input">
                                <option value="IN">ENTRY (IN) - Face/Thumb/Card</option>
                                <option value="OUT">EXIT (OUT) - Door Open Always</option>
                            </select>
                            <small style="color: var(--text-muted); display: block; margin-top: 5px;">
                                Use <b>ENTRY</b> for strict access rules & total count. <br>
                                Use <b>EXIT</b> for marking members as OUT.
                            </small>
                        </div>
                        <div class="device-actions">
                            <button id="connect-device-btn" class="btn btn-primary" onclick="app.connectDevice()">
                                <span class="btn-icon">üîå</span>
                                Add & Connect Device
                            </button>
                        </div>
                    </div>

                    <!-- Connected Devices Inventory -->
                    <div class="settings-card full-width">
                        <h3>üì± Connected Biometric Devices</h3>
                        <div class="device-list" id="connected-devices-list">
                            <div class="empty-devices">
                                <p>No devices connected. Add a device above to start.</p>
                            </div>
                        </div>
                        <div class="inventory-footer" style="margin-top: 20px; text-align: right;">
                            <button class="btn btn-outline btn-sm" onclick="app.syncZKTeco()">
                                <span class="btn-icon">üîÑ</span> Sync All Devices
                            </button>
                        </div>
                    </div>

                    <!-- Live Occupancy Details -->
                    <div class="settings-card">
                        <h3>üë• Who's Inside?</h3>
                        <div id="inside-members-list" class="mini-visitor-list">
                            <div class="empty-notif">Gym is currently empty</div>
                        </div>
                    </div>

                    <!-- Member Enrollment Card -->
                    <div class="settings-card full-width">
                        <h3>üë• Member Enrollment</h3>
                        <p class="card-description">Sync all active members to the biometric device</p>
                        <div class="enrollment-actions">
                            <button id="sync-all-members-btn" class="btn btn-success" onclick="app.syncAllMembers()"
                                disabled>
                                <span class="btn-icon">üîÑ</span>
                                Sync All Active Members
                            </button>
                            <button id="refresh-enrolled-btn" class="btn btn-secondary"
                                onclick="app.refreshEnrolledUsers()" disabled>
                                <span class="btn-icon">üìä</span>
                                Refresh Enrollment Status
                            </button>
                        </div>
                        <div id="enrollment-status" class="enrollment-status" style="display: none;">
                            <div class="status-progress">
                                <div id="enrollment-progress" class="progress-bar"></div>
                            </div>
                            <p id="enrollment-message" class="status-message"></p>
                        </div>
                    </div>

                    <!-- Quick Stats Card -->
                    <div class="settings-card">
                        <h3>üìä Quick Stats</h3>
                        <div class="quick-stats">
                            <div class="quick-stat-item">
                                <div class="stat-value" id="total-members-stat">0</div>
                                <div class="stat-label">Total Active Members</div>
                            </div>
                            <div class="quick-stat-item">
                                <div class="stat-value" id="enrolled-members-stat">0</div>
                                <div class="stat-label">Enrolled in Device</div>
                            </div>
                        </div>
                    </div>

                    <!-- Device Logs Card -->
                    <div class="settings-card">
                        <h3>üìù Recent Activity</h3>
                        <div id="device-activity-log" class="activity-log">
                            <p class="empty-text">No activity yet. Connect device to see logs.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Access Dashboard -->
            <section id="access-dashboard" class="access-dashboard" style="display: none;">
                <div class="access-header">
                    <h2>üö™ Access Monitoring</h2>
                    <div class="access-controls">
                        <button class="btn btn-outline" onclick="app.toggleView('list')">Back to Dashboard</button>
                    </div>
                </div>

                <div class="access-status-container">
                    <div id="access-main-card" class="access-card waiting">
                        <div class="access-icon-wrapper">
                            <div class="access-icon">üö™</div>
                        </div>
                        <div class="access-title">READY TO SCAN</div>
                        <p class="access-instruction">Please use the biometric device or scan your card</p>
                    </div>

                    <!-- Debug Diagnostics -->
                    <div class="debug-panel"
                        style="margin-top: 2rem; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 12px; border: 1px dashed rgba(255,255,255,0.1); width: 100%; max-width: 500px; margin-left: auto; margin-right: auto;">
                        <div id="scan-status"
                            style="margin-bottom: 1rem; padding: 0.5rem; border-radius: 6px; text-align: center; background: #334155; color: white;">
                            Waiting for scan... (Diagnosis)</div>
                        <div style="display: flex; gap: 0.5rem; justify-content: center;">
                            <button onclick="app.triggerBiometricMock('U010', 'IN')"
                                class="btn btn-sm btn-primary">Trigger Mock (U010 IN)</button>
                            <button onclick="app.testManualUI()" class="btn btn-sm btn-secondary">Test UI Logic</button>
                            <button onclick="app.testSocketLink()" class="btn btn-sm btn-outline">Test Socket
                                Link</button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Customer Modal -->
    <div id="customer-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Customer Profile</h2>
                <button class="close-btn" onclick="closeCustomerModal()">&times;</button>
            </div>

            <div class="modal-tabs">
                <button type="button" class="tab-btn active" id="profile-tab-btn"
                    onclick="app.showCustomerTab('profile')">Basic Info</button>
                <button type="button" class="tab-btn" id="timeline-tab-btn"
                    onclick="app.showCustomerTab('timeline')">Member Journey</button>
            </div>

            <div id="customer-profile-content" class="tab-content active">
                <form id="customer-form">
                    <!-- Profile Photo Section -->
                    <div class="profile-photo-section">
                        <div class="profile-photo-container">
                            <div class="profile-photo-preview" id="profile-photo-preview">
                                <img id="profile-image" src="" alt="Profile Photo" style="display: none;">
                                <div class="profile-placeholder" id="profile-placeholder">
                                    <span class="placeholder-icon">üì∑</span>
                                    <span class="placeholder-text">Add Photo</span>
                                </div>
                            </div>
                            <input type="file" id="profile-photo-input" accept="image/*" capture="user"
                                style="display: none;">
                            <button type="button" class="btn btn-secondary btn-camera" id="add-photo-btn">
                                <span class="btn-icon">üì∑</span>
                                Take Photo
                            </button>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="customer-name">Full Name *</label>
                            <input type="text" id="customer-name" required placeholder="Enter full name">
                        </div>
                        <div class="form-group">
                            <label for="customer-age">Age *</label>
                            <input type="number" id="customer-age" required min="10" max="120" placeholder="Enter age">
                        </div>
                        <div class="form-group">
                            <label for="customer-email">Email Address *</label>
                            <input type="email" id="customer-email" required placeholder="email@example.com">
                        </div>
                        <div class="form-group">
                            <label for="customer-phone">Phone Number *</label>
                            <input type="tel" id="customer-phone" required placeholder="+91 XXXXX XXXXX">
                        </div>
                        <div class="form-group">
                            <label for="customer-member-id">Member ID (for Biometrics)</label>
                            <input type="text" id="customer-member-id" placeholder="Optional: Scan tag or enter ID">
                        </div>
                        <div class="form-group">
                            <label for="customer-plan">Plan Type *</label>
                            <select id="customer-plan" class="ios-select" required>
                                <option value="">Select Plan</option>
                                <option value="Monthly">Monthly</option>
                                <option value="Quarterly">Quarterly (3 Months)</option>
                                <option value="Half-Yearly">Half-Yearly (6 Months)</option>
                                <option value="Yearly">Yearly (12 Months)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="customer-validity">Plan Validity (End Date) *</label>
                            <input type="date" id="customer-validity" required>
                        </div>
                    </div>

                    <!-- Initial Payment Section (Only for new customers) -->
                    <div id="initial-payment-section"
                        style="display: none; border-top: 1px solid rgba(255,255,255,0.1); margin: 15px 0; padding-top: 15px;">
                        <h3
                            style="font-size: 16px; color: var(--text-primary); margin-bottom: 15px; display: flex; align-items: center;">
                            <span style="margin-right: 8px;">üí≥</span> Initial Payment
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="initial-payment-amount">Amount Paid (‚Çπ)</label>
                                <input type="number" id="initial-payment-amount" placeholder="Enter amount">
                            </div>
                            <div class="form-group">
                                <label for="initial-payment-method">Payment Method</label>
                                <select id="initial-payment-method" class="ios-select">
                                    <option value="Cash">Cash</option>
                                    <option value="UPI">UPI</option>
                                    <option value="Card">Card</option>
                                    <option value="Bank Transfer">Bank Transfer</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="initial-payment-receipt">Receipt No (Optional)</label>
                                <input type="text" id="initial-payment-receipt" placeholder="Receipt Number">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="customer-notes">Additional Notes</label>
                        <textarea id="customer-notes" rows="3" placeholder="Any additional information..."></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeCustomerModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="submit-btn">
                            <span class="btn-icon">üíæ</span>
                            Save Customer
                        </button>
                    </div>
                </form>
            </div>

            <!-- Member Journey Timeline Tab Content -->
            <div id="customer-timeline-content" class="tab-content" style="display: none;">
                <div class="timeline-container">
                    <h3 style="margin: 0 0 20px 0; color: var(--text-primary);">üìÖ Member Journey Timeline</h3>
                    <div id="member-timeline" class="member-timeline">
                        <p class="loading-text">Click a tab to view member journey...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Confirm Delete</h2>
                <button class="close-btn" onclick="closeDeleteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete <strong id="delete-customer-name"></strong>?</p>
                <p class="warning-text">This action cannot be undone.</p>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirm-delete-btn">
                    <span class="btn-icon">üóëÔ∏è</span>
                    Delete Customer
                </button>
            </div>
        </div>
    </div>

    <!-- Image Enlargement Modal -->
    <div id="image-modal" class="modal">
        <div class="modal-content modal-image">
            <div class="modal-header">
                <h2>Profile Photo</h2>
                <button class="close-btn" onclick="app.closeImageModal()">&times;</button>
            </div>
            <div class="modal-body modal-image-body">
                <img id="enlarged-image" src="" alt="Profile Photo">
            </div>
            <div class="modal-actions" style="display: none;">
                <button type="button" class="btn btn-secondary" id="edit-photo-btn">
                    <span class="btn-icon">‚úèÔ∏è</span>
                    Edit Photo
                </button>
                <button type="button" class="btn btn-danger" id="delete-photo-btn">
                    <span class="btn-icon">üóëÔ∏è</span>
                    Delete Photo
                </button>
            </div>
        </div>
    </div>

    <!-- Camera Modal -->
    <div id="camera-modal" class="modal">
        <div class="modal-content modal-camera">
            <div class="modal-header">
                <h2>Take Photo</h2>
                <button class="close-btn" onclick="app.closeCameraModal()">√ó</button>
            </div>
            <div class="modal-body camera-body">
                <video id="camera-video" autoplay playsinline></video>
                <canvas id="camera-canvas" style="display: none;"></canvas>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeCameraModal()">Cancel</button>
                <button type="button" class="btn btn-primary" id="capture-photo-btn">
                    <span class="btn-icon">üì∏</span>
                    Capture Photo
                </button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="password-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Change Password</h2>
                <button class="close-btn" onclick="closePasswordModal()">&times;</button>
            </div>
            <form id="password-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="current-password">Current Password</label>
                        <input type="password" id="current-password" required placeholder="Enter current password">
                    </div>
                    <div class="form-group">
                        <label for="new-password">New Password</label>
                        <input type="password" id="new-password" required placeholder="Enter new password">
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirm New Password</label>
                        <input type="password" id="confirm-password" required placeholder="Confirm new password">
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closePasswordModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Password</button>
                </div>
            </form>
        </div>
    </div>



    <!-- Attendance Success Modal -->
    <div id="attendance-success-modal" class="modal">
        <div class="modal-content modal-small attendance-success-content">
            <div class="modal-body">
                <div class="success-animation" id="success-animation">
                    <div class="success-icon">‚úÖ</div>
                </div>
                <h2 id="attendance-member-name"></h2>
                <div class="attendance-status-badge" id="attendance-status-badge"></div>
                <p class="attendance-time" id="attendance-time"></p>
                <p class="attendance-message" id="attendance-message"></p>
            </div>
        </div>
    </div>

    <!-- Hamburger Menu Backdrop -->
    <div id="hamburger-backdrop" class="hamburger-backdrop" onclick="app.closeHamburgerMenu()"></div>

    <!-- Hamburger Menu -->
    <div id="hamburger-menu" class="hamburger-menu">
        <div class="hamburger-menu-content">
            <div class="hamburger-menu-header">
                <h3>Menu</h3>
                <button class="hamburger-close" onclick="app.closeHamburgerMenu()">√ó</button>
            </div>
            <div class="hamburger-menu-nav">
                <div class="menu-item" id="menu-home-btn">
                    <span class="menu-icon">üè†</span>
                    <span class="menu-text">Home / Member List</span>
                </div>

                <div class="menu-item" id="menu-add-customer-btn">
                    <span class="menu-icon">üë§</span>
                    <span class="menu-text">Add Customer</span>
                </div>

                <div class="menu-divider"></div>

                <div class="menu-item" id="menu-attendance-btn">
                    <span class="menu-icon">üìã</span>
                    <span class="menu-text">Attendance</span>
                </div>

                <div class="menu-item" id="menu-analytics-btn">
                    <span class="menu-icon">üìä</span>
                    <span class="menu-text">Analytics</span>
                </div>

                <div class="menu-item" id="menu-intelligence-btn">
                    <span class="menu-icon">üß†</span>
                    <span class="menu-text">Gym Intelligence</span>
                </div>

                <div class="menu-item" id="menu-device-settings-btn">
                    <span class="menu-icon">‚öôÔ∏è</span>
                    <span class="menu-text">Device Settings & Management</span>
                </div>

                <div class="menu-item" id="menu-access-btn">
                    <span class="menu-icon">üö™</span>
                    <span class="menu-text">Access Monitoring</span>
                </div>

                <div class="menu-divider"></div>

                <div class="menu-item" id="menu-announcements-btn">
                    <span class="menu-icon">üì¢</span>
                    <span class="menu-text">Announcements</span>
                </div>

                <div class="menu-divider"></div>

                <div class="menu-item" id="menu-import-btn">
                    <span class="menu-icon">üì•</span>
                    <span class="menu-text">Import Excel</span>
                </div>
                <input type="file" id="import-excel-input" accept=".xlsx, .xls" style="display: none;">

                <div class="menu-item" id="menu-export-btn">
                    <span class="menu-icon">üì§</span>
                    <span class="menu-text">Export Excel</span>
                </div>

                <div class="menu-divider"></div>

                <div class="menu-item" id="menu-theme-toggle">
                    <span class="menu-icon">üåô</span>
                    <span class="menu-text">Dark Mode</span>
                </div>

                <div class="menu-item" id="menu-password-btn">
                    <span class="menu-icon">üîí</span>
                    <span class="menu-text">Change Password</span>
                </div>
            </div>
        </div>
    </div>

    <div id="payment-modal" class="modal">
        <div class="modal-content payment-modal-content">
            <!-- Decorative Elements -->
            <div class="payment-modal-decoration">
                <div class="payment-glow payment-glow-1"></div>
                <div class="payment-glow payment-glow-2"></div>
            </div>

            <div class="modal-header payment-modal-header">
                <div class="payment-modal-title-wrapper">
                    <span class="payment-modal-icon">üí≥</span>
                    <h2>Record Payment</h2>
                </div>
                <button class="close-modal payment-close-btn" onclick="app.closePaymentModal()" aria-label="Close">
                    <span>&times;</span>
                </button>
            </div>

            <form id="payment-form" class="payment-form" onsubmit="app.handlePaymentSubmit(event)">
                <input type="hidden" id="payment-customer-id">

                <!-- Customer Name Field -->
                <div class="form-group payment-form-group">
                    <label class="payment-label">
                        <span class="payment-label-icon">üë§</span>
                        Customer Name
                    </label>
                    <div class="payment-input-wrapper">
                        <input type="text" id="payment-customer-name" class="payment-input payment-input-readonly"
                            readonly>
                    </div>
                </div>

                <!-- Amount and Date Row -->
                <div class="payment-form-row">
                    <div class="form-group payment-form-group">
                        <label class="payment-label">
                            <span class="payment-label-icon">üí∞</span>
                            Amount (‚Çπ)
                        </label>
                        <div class="payment-input-wrapper">
                            <input type="number" id="payment-amount" class="payment-input" required
                                placeholder="Enter amount">
                        </div>
                    </div>

                    <div class="form-group payment-form-group">
                        <label class="payment-label">
                            <span class="payment-label-icon">üìÖ</span>
                            Payment Date
                        </label>
                        <div class="payment-input-wrapper">
                            <input type="date" id="payment-date" class="payment-input" required>
                        </div>
                    </div>
                </div>

                <!-- Method and Plan Row -->
                <div class="payment-form-row">
                    <div class="form-group payment-form-group">
                        <label class="payment-label">
                            <span class="payment-label-icon">üí≥</span>
                            Payment Method
                        </label>
                        <div class="payment-input-wrapper">
                            <select id="payment-method" class="payment-input payment-select" required>
                                <option value="Cash">Cash</option>
                                <option value="UPI">UPI</option>
                                <option value="Card">Card</option>
                                <option value="Bank Transfer">Bank Transfer</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group payment-form-group">
                        <label class="payment-label">
                            <span class="payment-label-icon">üìã</span>
                            Plan Type
                        </label>
                        <div class="payment-input-wrapper">
                            <select id="payment-plan" class="payment-input payment-select" required>
                                <option value="Monthly">Monthly</option>
                                <option value="Quarterly">Quarterly</option>
                                <option value="Half-Yearly">Half-Yearly</option>
                                <option value="Yearly">Yearly</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Receipt Number -->
                <div class="form-group payment-form-group">
                    <label class="payment-label">
                        <span class="payment-label-icon">üßæ</span>
                        Receipt Number <span class="payment-optional">(Optional)</span>
                    </label>
                    <div class="payment-input-wrapper">
                        <input type="text" id="payment-receipt" class="payment-input"
                            placeholder="Enter receipt number">
                    </div>
                </div>

                <!-- Notes -->
                <div class="form-group payment-form-group">
                    <label class="payment-label">
                        <span class="payment-label-icon">üìù</span>
                        Notes
                    </label>
                    <div class="payment-input-wrapper">
                        <textarea id="payment-notes" rows="3" class="payment-input payment-textarea"
                            placeholder="Additional notes (optional)"></textarea>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="payment-submit-btn">
                    <span class="payment-submit-icon">‚úì</span>
                    <span class="payment-submit-text">Save Payment</span>
                    <div class="payment-submit-shine"></div>
                </button>
            </form>
        </div>
    </div>

    <!-- Payment View Overlay -->
    <div id="payment-view" class="view-overlay">
        <div class="view-header">
            <h2>Payment History</h2>
            <div style="flex: 1;"></div>
            <button class="btn btn-primary" onclick="app.exportPayments()" style="margin-right: 15px;">
                <span class="btn-icon">üìä</span> Export to Excel
            </button>
            <button class="btn-icon" onclick="app.togglePaymentView()">‚úï</button>
        </div>
        <div class="view-content">
            <div class="search-bar">
                <input type="text" id="payment-search"
                    placeholder="üîç Search payments by customer name, amount, or method..."
                    onkeyup="app.filterPayments()">
            </div>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Customer</th>
                            <th>Amount</th>
                            <th>Method</th>
                            <th>Plan</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="payment-table-body">
                        <!-- Payments will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Announcements View Overlay -->
    <div id="announcement-view" class="announcement-view-overlay" style="display: none;">
        <div class="announcement-view-header">
            <h2>üì¢ Announcements</h2>
            <button class="close-view-btn" onclick="app.toggleAnnouncementView()">‚úï</button>
        </div>
        <div class="announcement-view-content">

            <!-- Create Announcement Card -->
            <div class="announcement-create-card">
                <h3>‚ú® Create New Announcement</h3>
                <form id="announcement-form" onsubmit="app.handleAnnouncementSubmit(event)" class="announcement-form">
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label class="form-label">üìù Title</label>
                            <input type="text" id="ann-title" required class="form-input"
                                placeholder="Enter announcement title..." maxlength="100">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label class="form-label">üí¨ Message</label>
                            <textarea id="ann-message" required class="form-textarea" rows="3"
                                placeholder="Enter announcement message..." maxlength="500"></textarea>
                        </div>
                    </div>

                    <div class="form-row two-cols">
                        <div class="form-group">
                            <label class="form-label">üìÖ Start Date</label>
                            <input type="date" id="ann-start-date" required class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">üìÖ End Date</label>
                            <input type="date" id="ann-end-date" required class="form-input">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label class="form-label">üè∑Ô∏è Type</label>
                            <select id="ann-type" class="form-select">
                                <option value="info">‚ÑπÔ∏è Information</option>
                                <option value="important">‚ö†Ô∏è Important</option>
                                <option value="offer">üè∑Ô∏è Offer</option>
                                <option value="event">üéâ Event</option>
                                <option value="maintenance">üîß Maintenance</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-announcement-submit">
                        <span class="btn-icon">üì¢</span> Post Announcement
                    </button>
                </form>
            </div>

            <!-- Active Announcements Section -->
            <div class="announcement-list-section">
                <h3>üìã Active & Recent Announcements</h3>
                <div id="announcement-list" class="announcement-list">
                    <p class="loading-text">Loading announcements...</p>
                </div>
            </div>
        </div>
    </div>
    <!-- External Scripts -->
    <script>
        (function () {
            var script = document.createElement('script');
            // Use absolute URL to local backend by default
            var localUrl = "http://localhost:5000/socket.io/socket.io.js";
            script.src = localUrl;
            script.onerror = function () {
                console.warn('Local socket.io script failed to load from ' + localUrl + ', trying fallback CDN...');
                var fallback = document.createElement('script');
                fallback.src = "https://cdn.socket.io/4.8.1/socket.io.min.js";
                document.head.appendChild(fallback);
            };
            document.head.appendChild(script);
        })();
    </script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <!-- App Scripts -->
    <script src="api.js"></script>
    <script src="app.js"></script>
</body>

</html>