<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6c5ce7">
    <title>BMI Calculator - Mother Fitness Member</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="stylesheet" href="./styles.css?v=6.2.1">
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <a href="./dashboard.html" class="btn-back">‚Üê</a>
                <h1>BMI Calculator</h1>
                <div style="width: 40px;"></div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Unit Toggle -->
            <div class="profile-section fade-in">
                <div class="unit-toggle">
                    <button class="unit-btn active" data-unit="metric">Metric</button>
                    <button class="unit-btn" data-unit="imperial">Imperial</button>
                </div>
            </div>

            <!-- BMI Input Form -->
            <div class="profile-section fade-in" style="animation-delay: 0.1s;">
                <h3>üìè Enter Your Details</h3>
                <form id="bmiForm">
                    <!-- Metric Inputs -->
                    <div id="metricInputs">
                        <div class="form-group">
                            <label for="height">Height (cm)</label>
                            <input type="number" id="height" placeholder="170" min="50" max="300" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="weight">Weight (kg)</label>
                            <input type="number" id="weight" placeholder="70" min="20" max="300" step="0.1">
                        </div>
                    </div>

                    <!-- Imperial Inputs (hidden by default) -->
                    <div id="imperialInputs" style="display: none;">
                        <div class="form-group">
                            <label for="heightFt">Height (feet)</label>
                            <input type="number" id="heightFt" placeholder="5" min="3" max="8" step="1">
                        </div>
                        <div class="form-group">
                            <label for="heightIn">Height (inches)</label>
                            <input type="number" id="heightIn" placeholder="7" min="0" max="11" step="1">
                        </div>
                        <div class="form-group">
                            <label for="weightLbs">Weight (lbs)</label>
                            <input type="number" id="weightLbs" placeholder="154" min="44" max="660" step="0.1">
                        </div>
                    </div>

                    <button type="submit" class="btn-primary">Calculate BMI</button>
                </form>
            </div>

            <!-- BMI Result Card -->
            <div id="bmiResult" class="bmi-result-card" style="display: none;">
                <div class="bmi-score-circle">
                    <div class="bmi-score-value" id="bmiValue">0.0</div>
                    <div class="bmi-score-label">BMI</div>
                </div>
                <div class="bmi-category" id="bmiCategory">Normal Weight</div>
                <div class="bmi-range" id="bmiRange">18.5 - 24.9</div>

                <div class="bmi-indicator">
                    <div class="bmi-scale">
                        <div class="scale-segment underweight"></div>
                        <div class="scale-segment normal"></div>
                        <div class="scale-segment overweight"></div>
                        <div class="scale-segment obese"></div>
                    </div>
                    <div class="bmi-pointer" id="bmiPointer"></div>
                </div>

                <div class="bmi-tips" id="bmiTips">
                    <h4>üí° Health Tips</h4>
                    <p>Maintain a balanced diet and regular exercise routine.</p>
                </div>
            </div>

            <!-- Info Card -->
            <div class="profile-section fade-in" style="animation-delay: 0.2s;">
                <h3>‚ÑπÔ∏è About BMI</h3>
                <p style="font-size: 0.9rem; color: var(--text-secondary); line-height: 1.8;">
                    Body Mass Index (BMI) is a measure of body fat based on height and weight. While it's a useful
                    screening tool,
                    it doesn't directly measure body fat percentage. Consult with a healthcare professional for a
                    comprehensive health assessment.
                </p>

                <div class="bmi-categories-info">
                    <div class="category-item">
                        <span class="category-dot underweight"></span>
                        <span>Underweight: &lt; 18.5</span>
                    </div>
                    <div class="category-item">
                        <span class="category-dot normal"></span>
                        <span>Normal: 18.5 - 24.9</span>
                    </div>
                    <div class="category-item">
                        <span class="category-dot overweight"></span>
                        <span>Overweight: 25 - 29.9</span>
                    </div>
                    <div class="category-item">
                        <span class="category-dot obese"></span>
                        <span>Obese: ‚â• 30</span>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="./config.js?v=6.2.1"></script>
    <script src="./api.js?v=6.2.1"></script>
    <script src="./theme.js?v=6.2.1"></script>
    <script>
        const api = new MemberAPI();

        // Check auth
        if (!api.token) {
            window.location.href = './index.html';
        }

        let currentUnit = 'metric';

        // Unit toggle
        document.querySelectorAll('.unit-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                currentUnit = btn.dataset.unit;

                // Update active state
                document.querySelectorAll('.unit-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                // Show/hide inputs
                if (currentUnit === 'metric') {
                    document.getElementById('metricInputs').style.display = 'block';
                    document.getElementById('imperialInputs').style.display = 'none';
                } else {
                    document.getElementById('metricInputs').style.display = 'none';
                    document.getElementById('imperialInputs').style.display = 'block';
                }
            });
        });

        // BMI Calculation
        document.getElementById('bmiForm').addEventListener('submit', (e) => {
            e.preventDefault();

            let heightCm, weightKg;

            if (currentUnit === 'metric') {
                heightCm = parseFloat(document.getElementById('height').value);
                weightKg = parseFloat(document.getElementById('weight').value);
            } else {
                const feet = parseFloat(document.getElementById('heightFt').value);
                const inches = parseFloat(document.getElementById('heightIn').value);
                const lbs = parseFloat(document.getElementById('weightLbs').value);

                // Convert to metric
                heightCm = ((feet * 12) + inches) * 2.54;
                weightKg = lbs * 0.453592;
            }

            if (!heightCm || !weightKg) {
                alert('Please enter valid values');
                return;
            }

            // Calculate BMI
            const heightM = heightCm / 100;
            const bmi = (weightKg / (heightM * heightM)).toFixed(1);

            displayBMI(parseFloat(bmi));
        });

        function displayBMI(bmi) {
            const resultCard = document.getElementById('bmiResult');
            const bmiValue = document.getElementById('bmiValue');
            const bmiCategory = document.getElementById('bmiCategory');
            const bmiRange = document.getElementById('bmiRange');
            const bmiTips = document.getElementById('bmiTips');
            const bmiPointer = document.getElementById('bmiPointer');

            // Update value
            bmiValue.textContent = bmi;

            // Determine category
            let category, range, tips, color, position;

            if (bmi < 18.5) {
                category = 'Underweight';
                range = 'BMI < 18.5';
                tips = '<h4>üí° Health Tips</h4><p>Consider increasing calorie intake with nutrient-dense foods. Consult with a nutritionist for a personalized meal plan.</p>';
                color = '#3498db';
                position = (bmi / 18.5) * 25; // 0-25%
            } else if (bmi < 25) {
                category = 'Normal Weight';
                range = 'BMI 18.5 - 24.9';
                tips = '<h4>üí° Health Tips</h4><p>Great job! Maintain a balanced diet and regular exercise routine to stay healthy.</p>';
                color = '#00b894';
                position = 25 + ((bmi - 18.5) / 6.5) * 25; // 25-50%
            } else if (bmi < 30) {
                category = 'Overweight';
                range = 'BMI 25 - 29.9';
                tips = '<h4>üí° Health Tips</h4><p>Focus on portion control and increase physical activity. Aim for at least 150 minutes of moderate exercise per week.</p>';
                color = '#fdcb6e';
                position = 50 + ((bmi - 25) / 5) * 25; // 50-75%
            } else {
                category = 'Obese';
                range = 'BMI ‚â• 30';
                tips = '<h4>üí° Health Tips</h4><p>Consult with healthcare professionals for a comprehensive weight management plan. Regular medical check-ups are recommended.</p>';
                color = '#d63031';
                position = 75 + Math.min((bmi - 30) / 10, 1) * 25; // 75-100%
            }

            bmiCategory.textContent = category;
            bmiCategory.style.color = color;
            bmiRange.textContent = range;
            bmiTips.innerHTML = tips;

            // Position pointer
            bmiPointer.style.left = `${Math.min(position, 100)}%`;

            // Show result with animation
            resultCard.style.display = 'block';
            resultCard.classList.remove('fade-in');
            void resultCard.offsetWidth; // Trigger reflow
            resultCard.classList.add('fade-in', 'scale-in');

            // Scroll to result
            setTimeout(() => {
                resultCard.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }
    </script>
</body>

</html>